UPDATE PISO SET PRECIO = (PRECIO + 5) WHERE LOC = "L-Estartit";

UPDATE PISO SET COMISION = (COMISION + 5) WHERE COMISION <= 100;

DELETE FROM CAJA WHERE DIA = '2006-04-16';

DELETE FROM PEDIDO WHERE LLEGADA = '2006-04-17';

SELECT MAX(IMPORTE) AS MAXIMO, MIN(IMPORTE) AS MINIMO FROM CAJA WHERE PAGADO = 1 AND IMPORTE > 0 AND DIA between CAST('2005-11-14' AS DATE) and CAST('2006-02-01' AS DATE);

SELECT COUNT(N_PEDIDO) FROM PEDIDO WHERE LLEGADA = '2006-02-01';

SELECT COUNT(N_PISO) FROM PISO WHERE LOC = 'L-Estartit';

SELECT COUNT(N_PEDIDO) FROM PEDIDO WHERE N_PISO = 10 AND CANCELADO = 1;

SELECT NIF_CLI FROM PEDIDO WHERE PARTIDA  BETWEEN CAST('2005-10-01' AS DATE) AND CAST('2005-10-31' AS DATE);

SELECT NIF_PROP, APEL FROM PROP WHERE APEL LIKE '%u%';

SELECT N_PISO, PRECIO FROM PISO WHERE LOC IN('Pals', 'L-Escala') and PRECIO <= '50.00';

SELECT COUNT(NIF_PROP), LOC FROM PROP GROUP BY LOC;

SELECT COUNT(OPERACION), DIA FROM CAJA WHERE OPERACION='A' GROUP BY DIA;

SELECT PEDIDO.N_PEDIDO,((CAJA.IMPORTE*PISO.COMISION)/100) AS NUMERO FROM (PEDIDO INNER JOIN CAJA ON PEDIDO.N_PEDIDO = CAJA.N_PEDIDO) INNER JOIN PISO WHERE PEDIDO.N_PISO = PISO.N_PISO GROUP BY N_PEDIDO;

SELECT NIF_CLI, COUNT(N_PEDIDO) AS NUMERO FROM PEDIDO GROUP BY NIF_CLI;

SELECT PROP.NOMBRE, PROP.APEL, PISO.DIR, PISO.LOC FROM (PROP INNER JOIN PISO ON PROP.NIF_PROP = PISO.NIF_PROP);

SELECT N_FACTURA, OPERACION, IMPORTE, DIA FROM CAJA INNER JOIN PEDIDO ON CAJA.N_PEDIDO = PEDIDO.N_PEDIDO AND N_PISO = 5;

 SELECT PEDIDO.N_PEDIDO FROM PEDIDO INNER JOIN PISO ON PEDIDO.N_PISO = PISO.N_PISO AND PISO.DIR = "Av. Girona 10";

SELECT PROP.NOMBRE, PROP.APEL,SUM(PISO.PRECIO) AS NUMERO FROM PROP INNER JOIN PISO ON PROP.NIF_PROP= PISO.NIF_PROP GROUP BY PROP.NOMBRE;

SELECT CLI.NOMBRE, CLI.APEL, COUNT(PEDIDO.N_PEDIDO) AS NUMERO FROM CLI INNER JOIN PEDIDO ON CLI.NIF_CLI=PEDIDO.NIF_CLI GROUP BY NOMBRE;

SELECT DISTINCT c1.N_PEDIDO, c1.DIA FECHA_A , c2.DIA FECHA_B from CAJA c1 inner join CAJA c2 ON c1.N_PEDIDO = c2.N_PEDIDO WHERE c1.OPERACION IN ('A','B') and c2.OPERACION in ('A', 'B') group by c1.N_PEDIDO;

select distinct c1.N_PEDIDO, c1.DIA FECHA_A , c2.DIA FECHA_B from CAJA c1 inner join CAJA c2 ON c1.N_PEDIDO = c2.N_PEDIDO WHERE c1.OPERACION IN ('A','B') and c2.OPERACION in ('A', 'B') and c1.PAGADO in (1) and c2.PAGADO in(1) group by c1.N_PEDIDO;

SELECT p1.N_PISO, p1.DIR, p2.N_PISO, p2.DIR from PISO p1, PISO p2 WHERE p1.LOC = 'L-Estartit' AND p2.LOC = 'L-Escala' AND (p1.PRECIO + p2.PRECIO= 95.00);

SELECT PEDIDO.NIF_CLI FROM PEDIDO INNER JOIN PISO ON PEDIDO.N_PISO = PISO.N_PISO AND PISO.LOC='L-Escala';

SELECT CLI.NOMBRE, CLI.APEL FROM((CLI INNER JOIN PEDIDO ON CLI.NIF_CLI = PEDIDO.NIF_CLI) INNER JOIN PISO ON PEDIDO.N_PISO = PISO.N_PISO AND PISO.LOC='L-Escala');

SELECT PISO.DIR, PISO.LOC FROM PISO INNER JOIN PROP ON PISO.NIF_PROP=PROP.NIF_PROP AND PROP.NOMBRE = 'Antonia' AND PROP.APEL='Sierra Martin';

SELECT DIR, LOC, MIN(PRECIO) FROM PISO GROUP BY LOC;

SELECT DIR, LOC, PRECIO FROM PISO WHERE PRECIO >(SELECT AVG(PRECIO) FROM PISO);

